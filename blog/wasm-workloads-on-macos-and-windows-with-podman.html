<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Unlock WebAssembly on macOS &amp; Windows | Podman Desktop</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://podman-desktop.io/blog/wasm-workloads-on-macos-and-windows-with-podman"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Unlock WebAssembly on macOS &amp; Windows | Podman Desktop"><meta data-rh="true" name="description" content="Spinning a OCI container image containing a WebAssembly/Wasm workload on macOS or Windows should be as simple as running any other OCI image."><meta data-rh="true" property="og:description" content="Spinning a OCI container image containing a WebAssembly/Wasm workload on macOS or Windows should be as simple as running any other OCI image."><meta data-rh="true" property="og:image" content="https://podman-desktop.io/img/blog/run-webassembly-wasm-workloads-windows-and-macos/webassembly-podman.webp"><meta data-rh="true" name="twitter:image" content="https://podman-desktop.io/img/blog/run-webassembly-wasm-workloads-windows-and-macos/webassembly-podman.webp"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-01-29T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/benoitf"><meta data-rh="true" property="article:tag" content="podman-desktop,wasm,wasi,WebAssembly"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://podman-desktop.io/blog/wasm-workloads-on-macos-and-windows-with-podman"><link data-rh="true" rel="alternate" href="https://podman-desktop.io/blog/wasm-workloads-on-macos-and-windows-with-podman" hreflang="en"><link data-rh="true" rel="alternate" href="https://podman-desktop.io/blog/wasm-workloads-on-macos-and-windows-with-podman" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://MR01ANKQ9S-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Podman Desktop RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Podman Desktop Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Podman Desktop JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Podman Desktop" href="/opensearch.xml">

<link rel="preconnect" href="https://podman-desktop-website.goatcounter.com">
<script async src="//gc.zgo.at/count.js" data-goatcounter="https://podman-desktop-website.goatcounter.com/count"></script><link rel="stylesheet" href="/assets/css/styles.a4e6a070.css">
<script src="/assets/js/runtime~main.c8c458c7.js" defer="defer"></script>
<script src="/assets/js/main.3327777f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_oPtH" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Podman Desktop Logo" class="themedComponent_siVc themedComponent--light_hHel" height="56"><img src="/img/logo.svg" alt="Podman Desktop Logo" class="themedComponent_siVc themedComponent--dark_yETr" height="56"></div><b class="navbar__title text--truncate">podman desktop</b></a><a class="navbar__item navbar__link" href="/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/core-values">Core Values</a><a class="navbar__item navbar__link" href="/features">Features</a><a class="navbar__item navbar__link" href="/downloads">Downloads</a><a class="navbar__item navbar__link" href="/extend">Extend</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/containers/podman-desktop" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_ki11 colorModeToggle_Hewu"><button class="clean-btn toggleButton_MMFG toggleButtonDisabled_Uw7m" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_lgto"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_U96C"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_bzqh"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_MB5r"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_CLW8 thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_DQfJ margin-bottom--md">All blog posts</div><ul class="sidebarItemList_rvuc clean-list"><li class="sidebarItem__RMN"><a aria-current="page" class="sidebarItemLink_Ony9 sidebarItemLinkActive_MJ75" href="/blog/wasm-workloads-on-macos-and-windows-with-podman">Unlock WebAssembly on macOS &amp; Windows</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-1.7">Podman Desktop 1.7 Release</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/getting-started-with-compose">Getting started with Compose on Podman Desktop</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-1.6">Podman Desktop 1.6 Release</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/sharing-podman-images-with-kubernetes-cluster">Share your local podman images with the Kubernetes cluster</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-1.5">Podman Desktop 1.5 Release</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-1.4">Podman Desktop 1.4 Release</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-1.3">Podman Desktop 1.3 Release</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-1.2">Podman Desktop 1.2 Release</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-1.1">Podman Desktop 1.1 Release</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-1.0">Podman Desktop 1.0 Release</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-0.15">Release Notes - Podman Desktop 0.15</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/running-a-local-kubernetes-cluster-with-podman-desktop">Setting up and running a Kubernetes cluster locally with Podman Desktop</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-0.14">Release Notes - Podman Desktop 0.14</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-0.13">Release Notes - Podman Desktop 0.13</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/5-things-to-know-for-a-docker-user">5 things to know about Podman Desktop for a Docker user</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-0.12">Release Notes - Podman Desktop 0.12</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-0.11">Release Notes - Podman Desktop 0.11</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/podman-desktop-release-0.10">Release Notes - Podman Desktop 0.10</a></li><li class="sidebarItem__RMN"><a class="sidebarItemLink_Ony9" href="/blog/develop-using-devcontainer">Build &amp; run Podman Desktop in a DevContainer</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Spinning a OCI container image containing a WebAssembly/Wasm workload on macOS or Windows should be as simple as running any other OCI image."><link itemprop="image" href="https://podman-desktop.io/img/blog/run-webassembly-wasm-workloads-windows-and-macos/webassembly-podman.webp"><header><h1 class="title_Kdtz" itemprop="headline">Unlock WebAssembly on macOS &amp; Windows</h1><div class="container_iZB2 margin-vert--md"><time datetime="2024-01-29T00:00:00.000Z" itemprop="datePublished">January 29, 2024</time> · <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_v1VX"><div class="avatar margin-bottom--sm"><a href="https://github.com/benoitf" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/benoitf.png" alt="Florent Benoit" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/benoitf" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Florent Benoit</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Software Engineer</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Seamlessly run WebAssembly/Wasm binaries on macOS and Windows</p>
<p>You might have heard excitement recently about Wasm and WASI. Imagine a world where you can effortlessly run Wasm binaries and distribute them using Open Container Initiative (OCI) container images – a singular image deployable across multiple architectures.</p>
<p>Though the concept seemed straightforward, accomplishing this task proved to be quite challenging, particularly on macOS and Windows. The complexity comes from the additional virtual machine running Linux. This machine needs all of the dependencies and prerequisites correctly setup.</p>
<p>The wait is over. Our blog post unveils the solution, guiding you through the process of enabling Wasm workloads on both macOS and Windows.</p>
<p><img loading="lazy" alt="hero" src="/assets/images/webassembly-podman-e40f6760fbeda109aa109b4a4d926f40.webp" width="960" height="480" class="img_SS3x"></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="what-is-webassembly-">What is WebAssembly ?<a href="#what-is-webassembly-" class="hash-link" aria-label="Direct link to What is WebAssembly ?" title="Direct link to What is WebAssembly ?">​</a></h2>
<p><a href="https://webassembly.org/" target="_blank" rel="noopener noreferrer">WebAssembly</a> (abbreviated Wasm) was designed as a portable compilation target for programming languages, improving performance and portability of web applications (including gaming/emulators). Using a low-level binary format instead of JavaScript boosts applications to have near-native performance.</p>
<p>The binary format serves as a compilation target and it allows to use a wider range of programming languages such as C, C++, and Rust. While it was a browser/client technology, now it is evolving beyond the web, for example being adapted for use as a back-end or edge technology (this is for example what happened to Java that was first designed for the client side before landing to the server side).</p>
<p>The Wasm binary format was designed to be secure. Wasm modules are isolated from the rest of the system, and they cannot access any system resources without explicit permission. This makes Wasm modules very safe to run, even in untrusted environments. But on another hand, for developing backend applications, this restriction is limiting the usage of Wasm.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="the-extension-of-webassembly">The extension of WebAssembly<a href="#the-extension-of-webassembly" class="hash-link" aria-label="Direct link to The extension of WebAssembly" title="Direct link to The extension of WebAssembly">​</a></h2>
<p>WebAssembly System Interface (WASI) was born as an essential complement to WebAssembly.</p>
<p>It is a system interface that extends WebAssembly&#x27;s capabilities beyond the browser, making it suitable for a wider range of environments, including servers, edge devices, and more.</p>
<p>While with Wasm you had limited access to the host resources, WASI provides a standard set of system calls, enabling WebAssembly modules to interact with the host operating system in a secure and consistent manner: it includes filesystem access, sockets, and other low-level resources.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="running-webassembly-outside-the-browser">Running WebAssembly outside the browser<a href="#running-webassembly-outside-the-browser" class="hash-link" aria-label="Direct link to Running WebAssembly outside the browser" title="Direct link to Running WebAssembly outside the browser">​</a></h2>
<p>Wasm has shipped in the major browser engines so the usage of Wasm is possible without any 3rd party addition in the browser land. But when it comes to the edge/system usage, you need to find a virtual machine to run these workloads supporting WASI extension. And there is not only one application to run them, there are several Wasm runtimes such as WasmEdge, Wasmtime, Wasmer, and so on. All runtimes support different CPU architectures.</p>
<p>Since WASI is still maturing some of the API provided in these runtimes has not reached the standard, so users need to be careful to write portable applications that do not depend on a given runtime.</p>
<p>Besides running Wasm/WASI workloads on your computer, there is also the question of how you package this binary format, share, and distribute it. A convenient way to distribute and run these workloads is to use OCI images as it provides all the basics: package, storage and distribution of the binaries. Then comes the execution part.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="using-podman-engine-with-wasm">Using Podman engine with Wasm<a href="#using-podman-engine-with-wasm" class="hash-link" aria-label="Direct link to Using Podman engine with Wasm" title="Direct link to Using Podman engine with Wasm">​</a></h2>
<p>When using containers with Podman on macOS or Windows, you have a virtual machine called a &quot;Podman machine&quot; that is executing a Linux environment. We need to add support for Wasm inside this Linux environment. Podman is using the crun project as its OCI runtime, so crun needs to be able to run or delegate execution to Wasm runtimes. Lucky for us, crun supports Wasm execution.</p>
<p>From the user&#x27;s point of view, support for Wasm is provided as an additional platform. So when executing a Wasm workload, we specify as a platform <code>--platform=wasi/wasm</code> instead of for example <code>--platform=linux/arm64</code> or <code>--platform=linux/amd64</code>.</p>
<p>​</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="running-wasm-workload-with-podman">Running Wasm workload with podman<a href="#running-wasm-workload-with-podman" class="hash-link" aria-label="Direct link to Running Wasm workload with podman" title="Direct link to Running Wasm workload with podman">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="setup">Setup<a href="#setup" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup">​</a></h3>
<div class="tabs-container tabList_J5MA"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_l0OV tabs__item--active">Windows</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_l0OV">macOS</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_wHwb"><p>On Windows, ensure that your podman machine is a recent one. You can check using the <code>podman version</code> command.</p><p>Depending on the output of the command, you might have extra steps to do.</p><ul>
<li>Client&#x27;s version and server&#x27;s side version &gt;= v4.7.0: Nothing to do, Wasm support is already there using the wasmedge runtime by default.</li>
<li>Client&#x27;s version &gt;= 4.6.0 but server&#x27;s side version &lt; 4.7. You need to create a new podman machine using the command podman machine init --now wasm</li>
<li>Old client/old server (&lt; 4.7.0) or podman not being installed: follow the getting started at <a href="https://podman.io" target="_blank" rel="noopener noreferrer">podman.io</a></li>
</ul></div><div role="tabpanel" class="tabItem_wHwb" hidden=""><p>On macOS, ensure that your podman machine is a recent one. You can check using the <code>podman version</code> command. It requires v4.8+.</p><p>Depending on the output of the command, you might have extra steps to do.</p><ul>
<li>Client&#x27;s version and server&#x27;s side version &gt;= v4.8.0: Nothing to do, Wasm support is already there using the wasmedge runtime by default.</li>
<li>Client&#x27;s version &gt;= 4.8.0 but server&#x27;s side version &lt; 4.8. You need to create a new podman machine using the command podman machine init --now wasm</li>
<li>Old client/old server (&lt; 4.8.0) or podman not being installed: follow the getting started at <a href="https://podman.io" target="_blank" rel="noopener noreferrer">podman.io</a></li>
</ul></div></div></div>
<p> </p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="running-wasm-images">Running Wasm images<a href="#running-wasm-images" class="hash-link" aria-label="Direct link to Running Wasm images" title="Direct link to Running Wasm images">​</a></h3>
<p>Let&#x27;s try with a simple hello world sample.</p>
<p>We will use example coming from <a href="https://github.com/redhat-developer/podman-desktop-demo/tree/main/wasm/rust-hello-world" target="_blank" rel="noopener noreferrer">https://github.com/redhat-developer/podman-desktop-demo/tree/main/wasm/rust-hello-world</a></p>
<p>There is already an OCI image on quay.io</p>
<p>To run the workload, we will use the following command:</p>
<div class="language-shell-shession codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell-shession codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ podman run --platform wasi/wasm quay.io/podman-desktop-demo/wasm-rust-hello-world</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When running the command, you will see a Podman Hello World that was compiled using a Rust project using the println function and compiled into Wasm using <code>--target wasm32-wasi</code> parameter at compilation time.</p>
<p><img loading="lazy" alt="Hello World example running" src="/assets/images/wasm-hello-world-99612b86e6bdb59de87cb1e150e42a37.png" width="369" height="286" class="img_SS3x"></p>
<p>you can omit the <code>--platform wasi/wasm</code> flag but in that case you&#x27;ll get a warning that the platform of the image is not matching the platform of your computer (<code>WARNING: image platform (wasi/wasm) does not match the expected platform (linux/arm64)</code>)</p>
<p>From this point, you can run other OCI images using Wasm workloads, not only the podman hello world sample.</p>
<p><strong><em>NOTE:</em></strong> if you don&#x27;t have the prerequisites installed in your podman machine you will see this error: <code>Error: requested OCI runtime crun-wasm is not available: invalid argument</code></p>
<p>In that case you should check that the prerequisites from the previous section are met.</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="building-wasm-oci-images-with-podman">Building Wasm OCI images with podman<a href="#building-wasm-oci-images-with-podman" class="hash-link" aria-label="Direct link to Building Wasm OCI images with podman" title="Direct link to Building Wasm OCI images with podman">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="building-with-a-specific-platformarchitecture">Building with a specific platform/architecture<a href="#building-with-a-specific-platformarchitecture" class="hash-link" aria-label="Direct link to Building with a specific platform/architecture" title="Direct link to Building with a specific platform/architecture">​</a></h3>
<p>Running Wasm workload is an interesting use case from a consumer point of view. It helps to consume Wasm binaries. But another interesting case is to distribute and build these Wasm images so anyone could run them quickly.</p>
<p>The goal is to have a minimal image containing only the Wasm binary. For that we will use a multi-stage build. First stage will be the platform to build/compile the <code>.wasm</code> binary file and the second/last stage will copy the binary to a scratch image.</p>
<p>When building images it will use by default the architecture of the host operating system. If you are using a Mac computer with ARM chip, then the Linux images will default to <code>linux/arm64</code>. Using a mac/intel it will default to <code>linux/amd64</code> images. In the case of Wasm workloads, the expected target platform is <code>wasi/wasm</code>.</p>
<p>With podman we can use the flag <code>--platform=wasi/wasm</code> on the <code>podman build</code> command to specify the system/architecture. But if we do that, it means that if the Dockerfile or Containerfile contains as base image <code>FROM docker.io/redhat/ubi9-minimal</code> for example it will try to fetch a <code>ubi9-minimal</code> image using the <code>wasi/wasm</code> platform but of course it does not exist.</p>
<p>So we need to tweak the Containerfile to include a <code>--platform</code> directive inside the Containerfile.</p>
<p>Example of Containerfile:</p>
<div class="language-Dockerfile language-dockerfile codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token instruction"> </span><span class="token instruction options property">--platform</span><span class="token instruction options punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token instruction options string" style="color:rgb(255, 121, 198)">$BUILDPLATFORM</span><span class="token instruction"> docker.io/redhat/ubi9-minimal </span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token instruction"> builder</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Using this method, we will fetch an image matching our host architecture but as there is still the  <code>--platform=wasi/wasm</code> on the command line, the resulting image will use the right platform.</p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="source-code">Source code<a href="#source-code" class="hash-link" aria-label="Direct link to Source code" title="Direct link to Source code">​</a></h3>
<p>Here is a simple Containerfile to build a rust application using wasm32-wasi binary output and a multi-layer OCI image. One layer for the build (installing rust, dependencies and compiling the application) and one scratch layer where we only add the <code>.wasm</code> output and flag it as the entrypoint.</p>
<p>Source code is available at <a href="https://github.com/redhat-developer/podman-desktop-demo/tree/main/wasm/rust-hello-world" target="_blank" rel="noopener noreferrer">https://github.com/redhat-developer/podman-desktop-demo/tree/main/wasm/rust-hello-world</a></p>
<p><code>Containerfile</code> content:</p>
<div class="language-Dockerfile language-dockerfile codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Build using the host platform (and not target platform wasi/wasm)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token instruction"> </span><span class="token instruction options property">--platform</span><span class="token instruction options punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token instruction options string" style="color:rgb(255, 121, 198)">$BUILDPLATFORM</span><span class="token instruction"> docker.io/redhat/ubi9-minimal </span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token instruction"> builder</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># install rust and Wasm/WASI target</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">RUN</span><span class="token instruction"> curl --proto </span><span class="token instruction string" style="color:rgb(255, 121, 198)">&#x27;=https&#x27;</span><span class="token instruction"> --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y </span><span class="token instruction operator">\</span><span class="token instruction"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token instruction">    &amp;&amp; source </span><span class="token instruction string" style="color:rgb(255, 121, 198)">&quot;$HOME/.cargo/env&quot;</span><span class="token instruction"> &amp;&amp; rustup target add wasm32-wasi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># copy source code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">COPY</span><span class="token instruction"> Cargo.toml /app/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">COPY</span><span class="token instruction"> src /app/src </span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># change working directory</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">WORKDIR</span><span class="token instruction"> /app</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Build</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">RUN</span><span class="token instruction"> source </span><span class="token instruction string" style="color:rgb(255, 121, 198)">&quot;$HOME/.cargo/env&quot;</span><span class="token instruction"> &amp;&amp; cd /app &amp;&amp; cargo build --target wasm32-wasi --release</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># now copy the Wasm binary and flag it as the entrypoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">FROM</span><span class="token instruction"> scratch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">ENTRYPOINT</span><span class="token instruction"> [ </span><span class="token instruction string" style="color:rgb(255, 121, 198)">&quot;/rust-hello-world.wasm&quot;</span><span class="token instruction"> ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token instruction keyword" style="color:rgb(189, 147, 249);font-style:italic">COPY</span><span class="token instruction"> </span><span class="token instruction options property">--from</span><span class="token instruction options punctuation" style="color:rgb(248, 248, 242)">=</span><span class="token instruction options string" style="color:rgb(255, 121, 198)">builder</span><span class="token instruction"> /app/target/wasm32-wasi/release/rust-hello.wasm /rust-hello-world.wasm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>Cargo.toml</code> content:</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[package]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">name = &quot;rust-hello-world&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">version = &quot;0.1.0&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">edition = &quot;2021&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[[bin]]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">name = &quot;rust-hello&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">path = &quot;src/main.rs&quot;</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And the rust program <code>src/main.rs</code>:</p>
<div class="language-toml codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-toml codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  fn main() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // use of strings literal for multi-line string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // https://doc.rust-lang.org/reference/tokens.html#raw-string-literals</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // ascii art from Máirín Duffy @mairin</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let hello = r#&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">!... Hello Podman Wasm World ...!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         .--&quot;--.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       / -     - \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      / (O)   (O) \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ~~~| -=(,Y,)=- |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .---. /`  \   |~~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ~/  o  o \~~~~.----. ~~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  | =(X)= |~  / (O (O) \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ~~~~~~~  ~| =(Y_)=-  |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ~~~~    ~~~|   U      |~~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Project:   https://github.com/containers/podman</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Website:   https://podman.io</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Documents: https://docs.podman.io</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Twitter:   @Podman_io</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;#;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    println!(&quot;{}&quot;, hello);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>All the source code is available at <a href="https://github.com/redhat-developer/podman-desktop-demo/tree/main/wasm/rust-hello-world" target="_blank" rel="noopener noreferrer">https://github.com/redhat-developer/podman-desktop-demo/tree/main/wasm/rust-hello-world</a></p>
<h3 class="anchor anchorWithStickyNavbar_JmGV" id="building-wasm-images">Building Wasm images<a href="#building-wasm-images" class="hash-link" aria-label="Direct link to Building Wasm images" title="Direct link to Building Wasm images">​</a></h3>
<p>Run the command from the <code>wasm/rust-hello-world</code> folder if you cloned the repository or from the directory where all the files are present.</p>
<div class="language-shell-session codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell-session codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">podman build --platform=wasi/wasm -t rust-hello-world-wasm .</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>example of output will be :</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1/2] STEP 1/6: FROM docker.io/redhat/ubi9-minimal AS builder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Trying to pull docker.io/redhat/ubi9-minimal:latest...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Getting image source signatures</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copying blob sha256:472e9d218c02b84dcd7425232d8b1ac2928602de2de0efc01a7360d1d42bf2f6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copying config sha256:317fc66dad246d1fac6996189a26f85554dc9fc92ca23bf1e7bf10e16ead7c8c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Writing manifest to image destination</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1/2] STEP 2/6: RUN curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y     &amp;&amp; source &quot;$HOME/.cargo/env&quot; &amp;&amp; rustup target add wasm32-wasi</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: downloading installer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: profile set to &#x27;default&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: default host triple is aarch64-unknown-linux-gnu</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: syncing channel updates for &#x27;stable-aarch64-unknown-linux-gnu&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: latest update on 2023-10-05, rust version 1.73.0 (cc66ad468 2023-10-03)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: downloading component &#x27;cargo&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: downloading component &#x27;clippy&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: downloading component &#x27;rust-docs&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: downloading component &#x27;rust-std&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: downloading component &#x27;rustc&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: downloading component &#x27;rustfmt&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: installing component &#x27;cargo&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: installing component &#x27;clippy&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: installing component &#x27;rust-docs&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: installing component &#x27;rust-std&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: installing component &#x27;rustc&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: installing component &#x27;rustfmt&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: default toolchain set to &#x27;stable-aarch64-unknown-linux-gnu&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  stable-aarch64-unknown-linux-gnu installed - rustc 1.73.0 (cc66ad468 2023-10-03)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Rust is installed now. Great!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">To get started you may need to restart your current shell.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This would reload your PATH environment variable to include</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Cargo&#x27;s bin directory ($HOME/.cargo/bin).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">To configure your current shell, run:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">source &quot;$HOME/.cargo/env&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: downloading component &#x27;rust-std&#x27; for &#x27;wasm32-wasi&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">info: installing component &#x27;rust-std&#x27; for &#x27;wasm32-wasi&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; c93a3433d432</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1/2] STEP 3/6: COPY Cargo.toml /app/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; cf4488993835</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1/2] STEP 4/6: COPY src /app/src</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; 531b9389857c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1/2] STEP 5/6: WORKDIR /app</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; 23379392f585</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1/2] STEP 6/6: RUN source &quot;$HOME/.cargo/env&quot; &amp;&amp; cd /app &amp;&amp; cargo build --target wasm32-wasi --release</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   Compiling rust-hello-world v0.1.0 (/app)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Finished release [optimized] target(s) in 0.15s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; e3582e06f45b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2/2] STEP 1/3: FROM scratch</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2/2] STEP 2/3: ENTRYPOINT [ &quot;/rust-hello-world.wasm&quot; ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; 069b1742d906</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2/2] STEP 3/3: COPY --from=builder /app/target/wasm32-wasi/release/rust-hello.wasm /rust-hello-world.wasm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[2/2] COMMIT rust-hello-world-wasm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">--&gt; e0948298c0be</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Successfully tagged localhost/rust-hello-world-wasm:latest</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">e0948298c0be20e11da5d92646a2d6453f05e66671f72f0f792c1e1ff8de75ba</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This is a multi-stage build but at the end we only have a small image containing the Wasm binary.</p>
<p>Launch it quickly using</p>
<div class="language-shell-session codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-shell-session codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">podman run rust-hello-world-wasm</span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and we&#x27;ll see the expected output</p>
<div class="codeBlockContainer_mQmQ theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_D5yF"><pre tabindex="0" class="prism-code language-text codeBlock_RMoD thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_AclH"><span class="token-line" style="color:#F8F8F2"><span class="token plain">WARNING: image platform (wasi/wasm/v8) does not match the expected platform (linux/arm64)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">!... Hello Podman Wasm World ...!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         .--&quot;--.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       / -     - \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      / (O)   (O) \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ~~~| -=(,Y,)=- |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .---. /`  \   |~~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> ~/  o  o \~~~~.----. ~~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  | =(X)= |~  / (O (O) \</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ~~~~~~~  ~| =(Y_)=-  |</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ~~~~    ~~~|   U      |~~</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Project:   https://github.com/containers/podman</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Website:   https://podman.io</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Documents: https://docs.podman.io</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Twitter:   @Podman_io</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_aaMX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_z5j7" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_FoOz"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_L0B6"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>​</p>
<h2 class="anchor anchorWithStickyNavbar_JmGV" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>After witnessing the seamless execution and creation of WebAssembly (Wasm) workloads on both Windows and macOS through the utilization of podman, the possibilities are at your fingertips.</p>
<p>Now, the initiative lies with you to embark on your journey of exploring, experimenting, and pushing the boundaries.</p>
<p>Run and build new examples and do not hesitate to contribute to the podman community by reporting and discussing these issues.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_JgJa"><div class="col"><b>Tags:</b><ul class="tags_Ow0B padding--none margin-left--sm"><li class="tag_DFxh"><a class="tag_otG2 tagRegular_s0E1" href="/blog/tags/podman-desktop">podman-desktop</a></li><li class="tag_DFxh"><a class="tag_otG2 tagRegular_s0E1" href="/blog/tags/wasm">wasm</a></li><li class="tag_DFxh"><a class="tag_otG2 tagRegular_s0E1" href="/blog/tags/wasi">wasi</a></li><li class="tag_DFxh"><a class="tag_otG2 tagRegular_s0E1" href="/blog/tags/web-assembly">WebAssembly</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/blog/podman-desktop-release-1.7"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Podman Desktop 1.7 Release</div></a></nav></main><div class="col col--2"><div class="tableOfContents_XG6w thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-webassembly-" class="table-of-contents__link toc-highlight">What is WebAssembly ?</a></li><li><a href="#the-extension-of-webassembly" class="table-of-contents__link toc-highlight">The extension of WebAssembly</a></li><li><a href="#running-webassembly-outside-the-browser" class="table-of-contents__link toc-highlight">Running WebAssembly outside the browser</a></li><li><a href="#using-podman-engine-with-wasm" class="table-of-contents__link toc-highlight">Using Podman engine with Wasm</a></li><li><a href="#running-wasm-workload-with-podman" class="table-of-contents__link toc-highlight">Running Wasm workload with podman</a><ul><li><a href="#setup" class="table-of-contents__link toc-highlight">Setup</a></li><li><a href="#running-wasm-images" class="table-of-contents__link toc-highlight">Running Wasm images</a></li></ul></li><li><a href="#building-wasm-oci-images-with-podman" class="table-of-contents__link toc-highlight">Building Wasm OCI images with podman</a><ul><li><a href="#building-with-a-specific-platformarchitecture" class="table-of-contents__link toc-highlight">Building with a specific platform/architecture</a></li><li><a href="#source-code" class="table-of-contents__link toc-highlight">Source code</a></li><li><a href="#building-wasm-images" class="table-of-contents__link toc-highlight">Building Wasm images</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/installation">Installing Podman Desktop</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/migrating-from-docker">Migrating from Docker</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/kubernetes">Working with Kubernetes</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/troubleshooting">Troubleshooting</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/containers/podman-desktop" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.com/invite/x5GzFF6QH4" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chat (bridged): #podman-desktop on Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/containers/podman-desktop#communication" target="_blank" rel="noopener noreferrer" class="footer__link-item">Other ways to Communicate<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/orgs/containers/projects/4/views/8" target="_blank" rel="noopener noreferrer" class="footer__link-item">Current Sprint<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPrP"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 podman desktop - Apache License 2.0 License</div></div></div></footer></div>
</body>
</html>